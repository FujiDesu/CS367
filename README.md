# CS367 Lab & Homework - Student API (Individual Assignment)

## 1. การวางโครงสร้างระบบ
* **สิ่งที่ทำ:** ออกแบบโค้ดโดยแบ่งแยกหน้าที่การทำงานอย่างชัดเจน ได้แก่ `models` (กำหนดโครงสร้างข้อมูล), `config` (จัดการการตั้งค่าและเชื่อมต่อฐานข้อมูล), `repositories` (จัดการคำสั่ง Database), `services` (จัดการ Business Logic), และ `handlers` (จัดการ HTTP Request/Response)
* **ผลลัพธ์:** ทำให้โครงสร้างโปรเจกต์เป็นระเบียบและง่ายต่อการบำรุงรักษา แต่เมื่อเริ่มทดสอบการเชื่อมต่อฐานข้อมูลจริง พบข้อจำกัดเกี่ยวกับสภาพแวดล้อมของระบบปฏิบัติการในขั้นตอนถัดไป

## 2. การแก้ไขข้อจำกัด `CGO_ENABLED` สำหรับ SQLite บน Windows
* **ปัญหาที่พบ:** เมื่อเรียกใช้งานคำสั่ง `go run main.go` ระบบแสดงข้อผิดพลาดเกี่ยวกับ CGO สาเหตุเกิดจากไลบรารี SQLite มาตรฐาน (`go-sqlite3`) จำเป็นต้องพึ่งพา C Compiler (เช่น GCC/MinGW) ในการประมวลผล ซึ่งสภาพแวดล้อมบน Windows ไม่ได้ติดตั้งเครื่องมือดังกล่าวไว้
* **วิธีการแก้ไข:** ทำการเปลี่ยน Driver ของฐานข้อมูล โดยเลือกใช้ไลบรารีรูปแบบ Pure Go เพื่อให้สามารถทำงานแบบ Cross-platform ได้ทันทีโดยไม่ต้องพึ่งพา C Compiler
* **คำสั่งที่ใช้แก้ไข:**
  ```go
  // ในไฟล์ database.go ทำการเปลี่ยน Import เป็น:
  import "[github.com/glebarez/go-sqlite](https://github.com/glebarez/go-sqlite)"
จากนั้นรันคำสั่ง go mod tidy เพื่ออัปเดตไลบรารี และสั่ง go run main.go อีกครั้ง พบว่าเซิร์ฟเวอร์สามารถเริ่มต้นการทำงานและสร้างไฟล์ students.db ได้สำเร็จ (เมื่อตรวจสอบผ่านเว็บเบราว์เซอร์จะแสดงผลเป็น null)

3. ปัญหาการส่ง JSON Payload ผ่านคำสั่ง curl ใน Windows PowerShell
ปัญหาที่พบ: เมื่อต้องการทดสอบการทำงานของ API (POST Request) เพื่อเพิ่มข้อมูลนักเรียน ได้ทดลองใช้คำสั่ง curl.exe ผ่าน PowerShell แต่ระบบแสดงข้อผิดพลาด invalid character '\''' looking for beginning of object key string

สาเหตุ: เกิดจากข้อจำกัดของโปรแกรม PowerShell บน Windows ในการจัดการรูปแบบ String Escape และการตีความเครื่องหมายอัญประกาศ (Single/Double Quotes) ทำให้เซิร์ฟเวอร์ไม่สามารถประมวลผลข้อมูล JSON ที่ส่งไปได้อย่างถูกต้อง

4. การเพิ่มข้อมูลทดสอบผ่าน VS Code Extension ด้วยคำสั่ง SQL
วิธีการแก้ไข: เพื่อหลีกเลี่ยงข้อจำกัดของ PowerShell จึงเปลี่ยนวิธีการเพิ่มข้อมูลมาเป็นการจัดการฐานข้อมูลโดยตรงผ่านเครื่องมือภายใน VS Code

สิ่งที่ทำ: 1. ใช้ Extension SQLite เพื่อเปิดอ่านไฟล์ students.db
2. เปิดหน้าต่าง SQL Query และเขียนคำสั่งเพื่อเพิ่มข้อมูลด้วยตนเอง:

SQL
INSERT INTO students (id, name, major, gpa) 
VALUES ('6609650475', 'Nong Puti', 'CS', 0.01);
สั่งประมวลผลผ่าน "Run Selected Query" เพื่อบันทึกข้อมูลลงในตาราง

5. การตรวจสอบความถูกต้องของระบบ
สิ่งที่ทำ: ทำการโหลดหน้าเว็บ http://localhost:8080/students อีกครั้ง ในขณะที่ Gin Server ยังคงทำงานอยู่

ผลลัพธ์ที่ได้: ข้อมูล JSON ของนักเรียนที่เพิ่งเพิ่มลงในฐานข้อมูล ปรากฏขึ้นบนเบราว์เซอร์อย่างถูกต้องแทนที่ค่า null

ข้อสรุป: เป็นการยืนยันว่าสถาปัตยกรรม Layer ทั้งหมดของแอปพลิเคชัน (Handler -> Service -> Repository -> Database) สามารถเชื่อมต่อและประมวลผลร่วมกันได้อย่างสมบูรณ์แบบ
